<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ActivityThread on</title><link>https://guanpj.github.io/amethyst/tags/ActivityThread/</link><description>Recent content in ActivityThread on</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://guanpj.github.io/amethyst/tags/ActivityThread/index.xml" rel="self" type="application/rss+xml"/><item><title>五、App 启动流程分析</title><link>https://guanpj.github.io/amethyst/%E4%BA%94App-%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://guanpj.github.io/amethyst/%E4%BA%94App-%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/</guid><description>在我的上一篇文章 Android 系统启动流程分析中，我们分析了系统在开机以后的一系列行为，其中最后一阶段 AMS(ActivityManagerService) 会启动 Launcher 来展示我们手机中所有已安装的应用图标，点击图标后相应的应用程序将会被系统启动运行并展示在我们面前，那么，点击了图标之后系统道理做了哪些工作呢？应用进程是怎么被启动的呢？Activity 的生命周期是什么时候被谁调用的呢？本文将继续基于 Android Nougat 的 frameworks 层源码的解答这些问题。
阅读建议：
如果你是首次阅读这个过程的源码，建议你忽略一些细枝末节的代码，先抓主干代码，从整体上理解代码的执行流程（右下角文章目录视图中可以点击跳转到相应章节），否则将会被细节的代码扰乱思路。最后可以回头多看几遍，这时候如果有需要可以追踪一些枝干代码，做到融会贯通。
1. Launcher —— AMS # 1.1 调用过程分析 # 1.1.1 Launcher.onClick # 在 Launcher app 的主 Activity —— Launcher.java 中，App 图标的点击事件最终会回调 Launcher.java 中的 onClick 方法，
[packages/apps/Launcher3/src/com/android/launcher3/Launcher.java]( https://android.googlesource.com/platform/packages/apps/Launcher3/ /nougat-release/src/com/android/launcher3/Launcher.java?autodive=0/)：
public void onClick(View v) { ... Object tag = v.getTag(); if (tag instanceof ShortcutInfo) { // 从快捷方式图标启动 onClickAppShortcut(v); } else if (tag instanceof FolderInfo) { // 文件夹 if (v instanceof FolderIcon) { onClickFolderIcon(v); } } else if (v == mAllAppsButton) { // “所有应用”按钮 onClickAllAppsButton(v); } else if (tag instanceof AppInfo) { // 从“所有应用”中启动的应用 startAppShortcutOrInfoActivity(v); } else if (tag instanceof LauncherAppWidgetInfo) { // 组件 if (v instanceof PendingAppWidgetHostView) { onClickPendingWidget((PendingAppWidgetHostView) v); } } } 1.</description></item></channel></rss>